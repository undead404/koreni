<!doctype html>
<html lang="uk">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Koreni Dashboard</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/@staticcms/app@^4.0.0/dist/main.css"
    />
  </head>
  <body>
    <script>
      const authChannel = new BroadcastChannel('static-cms-auth');

      authChannel.onmessage = (event) => {
        if (event.data.type === 'auth-success') {
          console.log(
            'Auth message received via BroadcastChannel, bridging to CMS...',
          );

          // Send the handshake first
          window.postMessage('authorizing:github', window.location.origin);

          // Then send the data
          window.postMessage(event.data.data, window.location.origin);
        }
      };
    </script>
    <script src="https://unpkg.com/@staticcms/app@^4.0.0/dist/static-cms-app.js"></script>
    <script>
      window.CMS.init();
    </script>
  </body>
</html>
